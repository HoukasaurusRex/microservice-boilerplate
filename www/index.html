<!doctype html>
<html>
  <head>
    <title>A simple deployment with the Now API!</title>
    <link rel="stylesheet" href="/www/style.css">
  </head>
  <body>
    <h1>Welcome to a Static Site with Data from a Node.js API</h1>
    <h2>Deployed with <a href="https://zeit.co/docs" target="_blank" rel="noreferrer noopener">ZEIT Now</a>!</h2>
    <p><a href="https://github.com/zeit/now-examples/blob/master/nodejs" target="_blank" rel="noreferrer noopener">This project</a> includes three files. A static <code>www/index.html</code> (rewritten with <a href="https://zeit.co/docs/v2/deployments/routes/" target="_blank" rel="noreferrer noopener">Routes</a> for access from the root) file as the homepage, a static <code>www/style.css</code> file for styling, and a <code>api/date.js</code> serverless function that returns the date on invocation. See <a href="/api/date.js"><code>api/date.js</code> for the Date API with Node.js</a>.</p>
    <br />
    <h3>Screenshot API Response:</h3>
    <img src="" id="shot" class="shot" alt="Loading screenshot..." />

    <script>
      function main() {
        return fetch("/api/shot.js?type='png'&page='google.com'").then((res) => {
          if (!res.ok) {
            throw new Error('Failed to fetch screenshot')
          }
          return res.blob()
        }).then((blob) => {
          console.log({blob})
          const blobUrl = URL.createObjectURL(blob)
          console.log({blobUrl})
          document.querySelector("#shot").src = blobUrl
        }).catch(err => {
          document.querySelector("#shot").alt = err.message
        });
      }

      main();
    </script>
  </body>
</html>
